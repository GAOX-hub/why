<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<title>遗传密码子交互实验台</title>

<style>
/* ===== 页面基础 ===== */
body {
    margin: 0;
    font-family: "Microsoft YaHei", sans-serif;
    background: #e6f6ff;   /* 浅蓝背景 */
    color: #1f2937;
}

.page-outer {
    max-width: 1300px;
    margin: 30px auto;
    padding: 0 24px;
}

.page-wrap {
    background: #ffffff;
    border-radius: 28px;
    padding: 28px 32px 40px;
    box-shadow: 0 20px 40px rgba(0,0,0,0.08);
}

/* ===== 顶部标题 ===== */
header {
    text-align: center;
    margin-bottom: 24px;
}
header h1 {
    margin: 0;
    font-size: 34px;
    font-weight: 800;
    color: #0a3d62;
}
header p {
    margin-top: 6px;
    font-size: 15px;
    color: #6b7280;
}

/* ===== 上部两块布局：左拼装，右结果 ===== */
.layout {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 26px;
    margin-bottom: 26px;
}

.card {
    background: #f9fefe;
    border: 1px solid #e0f2f1;
    border-radius: 24px;
    padding: 24px 26px 28px;
    min-height: 260px;
    box-shadow: 0 12px 30px rgba(0,0,0,0.05);
}

.card h2 {
    font-size: 22px;
    margin: 0 0 10px;
    color: #064e3b;
}
.hint {
    font-size: 15px;
    color: #64748b;
    margin-bottom: 14px;
}

/* ===== 拼装按钮 ===== */
.bases {
    display: flex;
    gap: 10px;
    flex-wrap: wrap;
    margin-bottom: 14px;
}

.base-btn {
    min-width: 48px;
    padding: 8px 14px;
    border-radius: 999px;
    border: none;
    background: #14b8a6;
    color: white;
    font-size: 20px;
    cursor: pointer;
    box-shadow: 0 4px 10px rgba(20,184,166,.35);
}
.base-btn:hover {
    background: #0d9488;
}

/* ===== 密码子槽位 ===== */
.codon-display {
    display: flex;
    align-items: center;
    gap: 10px;
    margin-bottom: 12px;
}
.codon-slot {
    width: 50px;
    height: 50px;
    border-radius: 12px;
    border: 2px solid #a7f3d0;
    display: flex;
    justify-content: center;
    align-items: center;
    background: #f0fdfa;
    font-size: 28px;
    color: #065f46;
}
.builder-actions {
    margin-top: 6px;
}

/* ===== 统一的主按钮样式（查询 & 设为原始密码子） ===== */
.primary-btn {
    padding: 8px 16px;
    border-radius: 999px;
    border: none;
    background: #0ea5e9;
    color: #ecfeff;
    font-size: 15px;
    cursor: pointer;
    box-shadow: 0 4px 10px rgba(14,165,233,0.4);
}
.primary-btn:hover {
    background: #0284c7;
}

/* 小辅助按钮 */
.small-btn {
    padding: 6px 14px;
    border-radius: 14px;
    font-size: 14px;
    cursor: pointer;
    border: 1px solid #d1d5db;
    background: white;
}
.small-btn:hover {
    background: #f3f4f6;
}

/* ===== 查询结果（右侧卡片） ===== */
.result-card {
    background: #ffffff;
    border-radius: 24px;
    padding: 24px 26px 28px;
    border: 1px solid #e2e8f0;
    min-height: 260px;
    box-shadow: 0 12px 30px rgba(0,0,0,0.05);
}

/* —— 查询结果标题 —— */
.result-title {
    text-align: center;
    font-size: 24px;
    font-weight: bold;
    margin-bottom: 18px;
    color: #0f172a;
}

/* —— 结果文本、突变文本（两列左对齐） —— */
.result-text,
.result-line {
    font-size: 18px;
    margin: 8px 0;
    font-weight: 600;
    display: flex;
    align-items: center;
}

/* 左侧标签列，统一宽度，保证答案左对齐 */
.result-label {
    width: 220px;
    flex-shrink: 0;
    color: #111827;
}

/* ===== 标签样式 ===== */
.tag {
    display: inline-block;
    padding: 6px 16px;
    border-radius: 12px;
    font-size: 18px;
    font-weight: 600;
    background: linear-gradient(135deg, #d7f3ff, #9be3ff);
    color: #075985;
}

/* ===== 突变模拟器部分 ===== */
.mut-card {
    background: #ffffff;
    border-radius: 24px;
    padding: 24px 26px 28px;
    border: 1px solid #e2e8f0;
    box-shadow: 0 12px 30px rgba(0,0,0,0.05);
    margin-top: 10px;
}
.mut-title {
    text-align: left;
    font-size: 22px;
    font-weight: 700;
    color: #064e3b;
    margin: 0 0 16px;
}
.flex-row {
    display: flex;
    flex-wrap: wrap;
    gap: 20px;
}
.flex-item {
    flex: 1 1 320px;
}

.orig-input-row {
    display: flex;
    gap: 10px;
    align-items: center;
    margin-bottom: 8px;
}
#orig-input {
    padding: 8px 12px;
    border-radius: 999px;
    border: 2px solid #bae6fd;
    font-size: 18px;
    width: 140px;
    text-transform: uppercase;
}
.error {
    margin-top: 4px;
    font-size: 13px;
    color: #b91c1c;
}
.result-block {
    margin-top: 10px;
}

/* 突变下拉框 */
.codon-select-row {
    display: flex;
    align-items: center;
    gap: 8px;
    margin-bottom: 8px;
}
.codon-pos {
    padding: 6px 8px;
    border-radius: 10px;
    border: 1px solid #cbd5e1;
    font-size: 18px;
    width: 60px;
    text-align: center;
}

/* 突变类型标签 */
.mut-type {
    display: inline-block;
    padding: 4px 10px;
    border-radius: 999px;
    font-weight: 700;
    font-size: 15px;
    margin-left: 8px;
}
.mut-syn { background:#ecfeff; color:#0369a1; border:1px solid #7dd3fc; }
.mut-mis { background:#fef3c7; color:#92400e; border:1px solid #facc15; }
.mut-non { background:#fee2e2; color:#b91c1c; border:1px solid #fca5a5; }
.mut-stoploss { background:#ede9fe; color:#5b21b6; border:1px solid #c4b5fd; }
.mut-none { background:#e5e7eb; color:#374151; border:1px solid #d1d5db; }

/* 突变说明：加粗 */
.mut-desc {
    font-size: 14px;
    color: #4b5563;
    margin-top: 4px;
    font-weight: 700;
}

@media (max-width: 900px) {
    .layout { grid-template-columns: 1fr; }
    .flex-row { flex-direction: column; }
}
</style>

<script>
/* ================= 顶部交互（拼装 + 查询）：支持完整 64 种密码子 ================= */

/* 完整标准遗传密码表（RNA） */
const CODON_TABLE = {
  "UUU": { aa: "Phe", name: "苯丙氨酸" },
  "UUC": { aa: "Phe", name: "苯丙氨酸" },
  "UUA": { aa: "Leu", name: "亮氨酸" },
  "UUG": { aa: "Leu", name: "亮氨酸" },
  "CUU": { aa: "Leu", name: "亮氨酸" },
  "CUC": { aa: "Leu", name: "亮氨酸" },
  "CUA": { aa: "Leu", name: "亮氨酸" },
  "CUG": { aa: "Leu", name: "亮氨酸" },
  "AUU": { aa: "Ile", name: "异亮氨酸" },
  "AUC": { aa: "Ile", name: "异亮氨酸" },
  "AUA": { aa: "Ile", name: "异亮氨酸" },
  "AUG": { aa: "Met", name: "甲硫氨酸" },
  "GUU": { aa: "Val", name: "缬氨酸" },
  "GUC": { aa: "Val", name: "缬氨酸" },
  "GUA": { aa: "Val", name: "缬氨酸" },
  "GUG": { aa: "Val", name: "缬氨酸" },
  "UCU": { aa: "Ser", name: "丝氨酸" },
  "UCC": { aa: "Ser", name: "丝氨酸" },
  "UCA": { aa: "Ser", name: "丝氨酸" },
  "UCG": { aa: "Ser", name: "丝氨酸" },
  "AGU": { aa: "Ser", name: "丝氨酸" },
  "AGC": { aa: "Ser", name: "丝氨酸" },
  "CCU": { aa: "Pro", name: "脯氨酸" },
  "CCC": { aa: "Pro", name: "脯氨酸" },
  "CCA": { aa: "Pro", name: "脯氨酸" },
  "CCG": { aa: "Pro", name: "脯氨酸" },
  "ACU": { aa: "Thr", name: "苏氨酸" },
  "ACC": { aa: "Thr", name: "苏氨酸" },
  "ACA": { aa: "Thr", name: "苏氨酸" },
  "ACG": { aa: "Thr", name: "苏氨酸" },
  "GCU": { aa: "Ala", name: "丙氨酸" },
  "GCC": { aa: "Ala", name: "丙氨酸" },
  "GCA": { aa: "Ala", name: "丙氨酸" },
  "GCG": { aa: "Ala", name: "丙氨酸" },
  "UAU": { aa: "Tyr", name: "酪氨酸" },
  "UAC": { aa: "Tyr", name: "酪氨酸" },
  "UAA": { aa: "Stop", name: "终止密码子" },
  "UAG": { aa: "Stop", name: "终止密码子" },
  "UGA": { aa: "Stop", name: "终止密码子" },
  "UGU": { aa: "Cys", name: "半胱氨酸" },
  "UGC": { aa: "Cys", name: "半胱氨酸" },
  "UGG": { aa: "Trp", name: "色氨酸" },
  "CAU": { aa: "His", name: "组氨酸" },
  "CAC": { aa: "His", name: "组氨酸" },
  "CAA": { aa: "Gln", name: "谷氨酰胺" },
  "CAG": { aa: "Gln", name: "谷氨酰胺" },
  "AAU": { aa: "Asn", name: "天冬酰胺" },
  "AAC": { aa: "Asn", name: "天冬酰胺" },
  "AAA": { aa: "Lys", name: "赖氨酸" },
  "AAG": { aa: "Lys", name: "赖氨酸" },
  "GAU": { aa: "Asp", name: "天冬氨酸" },
  "GAC": { aa: "Asp", name: "天冬氨酸" },
  "GAA": { aa: "Glu", name: "谷氨酸" },
  "GAG": { aa: "Glu", name: "谷氨酸" },
  "CGU": { aa: "Arg", name: "精氨酸" },
  "CGC": { aa: "Arg", name: "精氨酸" },
  "CGA": { aa: "Arg", name: "精氨酸" },
  "CGG": { aa: "Arg", name: "精氨酸" },
  "AGA": { aa: "Arg", name: "精氨酸" },
  "AGG": { aa: "Arg", name: "精氨酸" },
  "GGU": { aa: "Gly", name: "甘氨酸" },
  "GGC": { aa: "Gly", name: "甘氨酸" },
  "GGA": { aa: "Gly", name: "甘氨酸" },
  "GGG": { aa: "Gly", name: "甘氨酸" }
};

let codon = ["", "", ""]; // 左侧拼装密码子

function addBase(b) {
    for (let i = 0; i < 3; i++) {
        if (codon[i] === "") {
            codon[i] = b;
            break;
        }
    }
    updateSlots();
}

function removeLast() {
    for (let i = 2; i >= 0; i--) {
        if (codon[i] !== "") {
            codon[i] = "";
            break;
        }
    }
    updateSlots();
}

function clearCodon() {
    codon = ["", "", ""];
    updateSlots();
}

function updateSlots() {
    document.getElementById("s1").innerText = codon[0];
    document.getElementById("s2").innerText = codon[1];
    document.getElementById("s3").innerText = codon[2];
}

function complementRNA(base) {
  switch (base) {
    case "A": return "U";
    case "U": return "A";
    case "C": return "G";
    case "G": return "C";
    default: return "";
  }
}
function rnaToDnaTemplate(codon) {
  const map = { A: "T", U: "A", C: "G", G: "C" };
  return codon.split("").map(b => map[b] || "_").join("");
}

// 获取同义密码子列表
function getSynonymousCodons(aaCode) {
  const list = Object.entries(CODON_TABLE)
    .filter(([c, info]) => info.aa === aaCode)
    .map(([c]) => c)
    .sort();
  return list;
}

function queryCodon() {
    if (codon.includes("")) {
        alert("请先拼装完整的三联体密码子！");
        return;
    }
    const input = codon.join("");  // mRNA 5'→3'

    const info = CODON_TABLE[input];
    if (!info) {
        alert("该密码子在标准遗传密码表中未找到。");
        return;
    }

    const aaLabel = info.aa === "Stop"
      ? info.name
      : `${info.name} (${info.aa})`;

    const anticodon = input.split("").map(complementRNA).reverse().join("");
    const dnaTemplate = rnaToDnaTemplate(input);

    const synList = getSynonymousCodons(info.aa);
    const synText = synList.length ? synList.join("，") : input;

    document.getElementById("mRNA_show").innerText = input;
    document.getElementById("aa_show").innerText = aaLabel;
    document.getElementById("tRNA_show").innerText = anticodon;
    document.getElementById("DNA_show").innerText = dnaTemplate;
    document.getElementById("synonym_show").innerText = synText;
}

/* ================= 下方：密码子突变模拟器 ================= */

let originalCodon = "AUG"; // 默认

function normalizeCodon(raw) {
  if (!raw) return { ok: false, error: "请输入 3 个碱基。" };
  let s = raw.trim().toUpperCase();
  if (s.length !== 3) return { ok: false, error: "密码子长度必须为 3。" };
  s = s.replace(/T/g, "U"); // DNA 中 T 当作 U
  if (!/^[AUCG]{3}$/.test(s)) return { ok: false, error: "只允许 A/U/C/G（或含 T 的 DNA 密码子）。" };
  return { ok: true, codon: s };
}

function getCodonInfo(codonStr) {
  const info = CODON_TABLE[codonStr];
  if (!info) return null;
  return {
    aaCode: info.aa,
    aaName: info.name,
    isStop: info.aa === "Stop",
    label: info.aa === "Stop" ? info.name : `${info.name} (${info.aa})`
  };
}

// 设置原始密码子
function setOriginal() {
  const raw = document.getElementById("orig-input").value || originalCodon;
  const res = normalizeCodon(raw);
  const errEl = document.getElementById("error-msg");
  const origInfoBlock = document.getElementById("orig-info");

  if (!res.ok) {
    errEl.textContent = res.error;
    origInfoBlock.style.display = "none";
    document.getElementById("mut-info").style.display = "none";
    return;
  }
  const info = getCodonInfo(res.codon);
  if (!info) {
    errEl.textContent = "该密码子在标准遗传密码表中未找到。";
    origInfoBlock.style.display = "none";
    document.getElementById("mut-info").style.display = "none";
    return;
  }

  errEl.textContent = "";
  originalCodon = res.codon;

  document.getElementById("orig-codon-tag").textContent = originalCodon;
  document.getElementById("orig-aa-tag").textContent = info.label;
  origInfoBlock.style.display = "block";

  // 显示下拉框和结果区
  document.getElementById("mut-block").style.display = "block";

  // 同步下拉框为当前原始密码子
  document.getElementById("pos1").value = originalCodon[0];
  document.getElementById("pos2").value = originalCodon[1];
  document.getElementById("pos3").value = originalCodon[2];

  updateMutation();
}

// 更新突变结果
function updateMutation() {
  const mutCodon =
    document.getElementById("pos1").value +
    document.getElementById("pos2").value +
    document.getElementById("pos3").value;

  const origInfo = getCodonInfo(originalCodon);
  const mutInfo = getCodonInfo(mutCodon);
  const block = document.getElementById("mut-info");
  const typeTag = document.getElementById("mut-type-tag");
  const descEl = document.getElementById("mut-desc");

  if (!origInfo || !mutInfo) {
    block.style.display = "none";
    return;
  }

  document.getElementById("mut-codon-tag").textContent = mutCodon;
  document.getElementById("mut-aa-tag").textContent = mutInfo.label;
  block.style.display = "block";

  let typeText = "";
  let typeClass = "mut-none";
  let descText = "";

  if (mutCodon === originalCodon) {
    typeText = "未发生突变";
    typeClass = "mut-none";
    descText = "密码子与原始相同，氨基酸不变。";
  } else if (!origInfo.isStop && mutInfo.isStop) {
    typeText = "无义突变";
    typeClass = "mut-non";
    descText = "突变后变成终止密码子，提前终止翻译。";
  } else if (origInfo.isStop && !mutInfo.isStop) {
    typeText = "终止丢失";
    typeClass = "mut-stoploss";
    descText = "原本是终止密码子，突变后不再终止。";
  } else if (mutInfo.aaCode === origInfo.aaCode) {
    typeText = "同义突变";
    typeClass = "mut-syn";
    descText = "密码子改变，但氨基酸相同。";
  } else {
    typeText = "错义突变";
    typeClass = "mut-mis";
    descText = "密码子改变，氨基酸不同。";
  }

  const diffs = [];
  for (let i = 0; i < 3; i++) {
    if (originalCodon[i] !== mutCodon[i]) diffs.push(i + 1);
  }
  if (diffs.length > 0) {
    descText += `（变化位置：第 ${diffs.join("，第 ")} 位）`;
  }

  typeTag.className = "mut-type " + typeClass;
  typeTag.textContent = typeText;
  descEl.textContent = descText;
}

window.addEventListener("DOMContentLoaded", () => {
  document.getElementById("set-orig-btn").addEventListener("click", setOriginal);
  document.getElementById("pos1").addEventListener("change", updateMutation);
  document.getElementById("pos2").addEventListener("change", updateMutation);
  document.getElementById("pos3").addEventListener("change", updateMutation);

  // 下方突变区默认隐藏（没输入前不显示）
  document.getElementById("mut-block").style.display = "none";
});
</script>
</head>

<body>

<div class="page-outer">
<div class="page-wrap">

<header>
    <h1>遗传密码子交互实验台</h1>
    <p>拼装密码子，查看编码信息，并模拟突变类型</p>
</header>

<!-- ===== 上部分：左拼装 / 右结果 ===== -->
<div class="layout">

    <!-- 左：拼装密码子 -->
    <div class="card">
        <h2>拼装密码子</h2>
        <p class="hint">依次点击 A / U / G / C，构建一个 mRNA 三联体密码子（5′→3′）。</p>

        <div class="bases">
            <button class="base-btn" onclick="addBase('A')">A</button>
            <button class="base-btn" onclick="addBase('U')">U</button>
            <button class="base-btn" onclick="addBase('G')">G</button>
            <button class="base-btn" onclick="addBase('C')">C</button>
        </div>

        <div class="codon-display">
            <div id="s1" class="codon-slot"></div>
            <div id="s2" class="codon-slot"></div>
            <div id="s3" class="codon-slot"></div>
            <span style="font-size:15px; color:#64748b;">mRNA 5′→3′</span>
        </div>

        <div class="builder-actions">
            <button class="small-btn" onclick="removeLast()">删除最后一位</button>
            <button class="small-btn" onclick="clearCodon()">清空密码子</button>
            <!-- 查询按钮：使用和“设为原始密码子”一样的样式 -->
            <button class="primary-btn" onclick="queryCodon()">查询</button>
        </div>
    </div>

    <!-- 右：查询结果 -->
    <div class="result-card">
        <h2 class="result-title">查询结果</h2>

        <div class="result-text">
            <span class="result-label">DNA 模板链（3′→5′）：</span>
            <span id="DNA_show" class="tag">—</span>
        </div>

        <div class="result-text">
            <span class="result-label">mRNA 密码子（5′→3′）：</span>
            <span id="mRNA_show" class="tag">—</span>
        </div>

        <div class="result-text">
            <span class="result-label">tRNA 反密码子（3′→5′）：</span>
            <span id="tRNA_show" class="tag">—</span>
        </div>

        <div class="result-text">
            <span class="result-label">氨基酸：</span>
            <span id="aa_show" class="tag">—</span>
        </div>

        <div class="result-text">
            <span class="result-label">同义密码子：</span>
            <span id="synonym_show" class="tag">—</span>
        </div>
    </div>

</div>

<!-- ===== 下方：密码子突变模拟器 ===== -->
<div class="mut-card">
  <h2 class="mut-title">密码子突变模拟器</h2>

  <div class="flex-row">
    <!-- 左：输入原始密码子 -->
    <div class="flex-item">
      <div class="orig-input-row">
        <input id="orig-input" type="text" maxlength="3" placeholder="例如 AUG">
        <button id="set-orig-btn" class="primary-btn">设为原始密码子</button>
      </div>
      <div id="error-msg" class="error"></div>

      <div id="orig-info" class="result-block" style="display:none;">
        <div class="result-line">
          <span class="result-label">原始密码子：</span>
          <span id="orig-codon-tag" class="tag"></span>
        </div>
        <div class="result-line">
          <span class="result-label">原始氨基酸：</span>
          <span id="orig-aa-tag" class="tag tag-aa"></span>
        </div>
      </div>
    </div>

    <!-- 右：修改碱基，观察突变 -->
    <div class="flex-item" id="mut-block" style="display:none;">
      <div class="codon-select-row">
        <span class="result-label">请选择突变：</span>
        <select id="pos1" class="codon-pos">
          <option>A</option><option>U</option><option>G</option><option>C</option>
        </select>
        <select id="pos2" class="codon-pos">
          <option>A</option><option>U</option><option>G</option><option>C</option>
        </select>
        <select id="pos3" class="codon-pos">
          <option>A</option><option>U</option><option>G</option><option>C</option>
        </select>
      </div>

      <div id="mut-info" class="result-block" style="display:none;">
        <div class="result-line">
          <span class="result-label">突变后密码子：</span>
          <span id="mut-codon-tag" class="tag"></span>
        </div>
        <div class="result-line">
          <span class="result-label">突变后氨基酸：</span>
          <span id="mut-aa-tag" class="tag tag-aa"></span>
        </div>
        <div class="result-line">
          <span class="result-label">突变类型：</span>
          <span id="mut-type-tag" class="mut-type mut-none">—</span>
        </div>
        <div id="mut-desc" class="mut-desc"></div>
      </div>
    </div>
  </div>
</div>

</div>
</div>

</body>
</html>
